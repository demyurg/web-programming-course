<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Backend API with Hono + TypeScript</title>
  <link rel="stylesheet" href="reset.css">
  <link rel="stylesheet" href="reveal.css">
  <link rel="stylesheet" href="black.css">
  <link rel="stylesheet" href="monokai.css">
  <style>
    .reveal h1, .reveal h2, .reveal h3 {
      text-transform: none;
    }

    .reveal section img {
      border: none;
      box-shadow: none;
      background: none;
    }

    .reveal pre {
      width: 100%;
      font-size: 0.38em;
      line-height: 1.2;
      max-height: 70vh;
      overflow-y: auto;
    }

    .reveal code {
      font-family: 'Courier New', monospace;
      background: rgba(255,255,255,0.1);
      padding: 2px 6px;
      border-radius: 3px;
    }

    .two-columns {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      align-items: start;
    }

    .two-columns ul {
      list-style: none;
    }

    .two-columns li {
      margin: 10px 0;
    }

    .highlight-box {
      background: rgba(102, 126, 234, 0.2);
      border-left: 4px solid #667eea;
      padding: 20px;
      margin: 20px 0;
      border-radius: 4px;
    }

    .success-box {
      background: rgba(76, 175, 80, 0.2);
      border-left: 4px solid #4caf50;
      padding: 20px;
      margin: 20px 0;
      border-radius: 4px;
    }

    .error-box {
      background: rgba(244, 67, 54, 0.2);
      border-left: 4px solid #f44336;
      padding: 20px;
      margin: 20px 0;
      border-radius: 4px;
    }

    .text-small {
      font-size: 0.8em;
    }

    .text-smaller {
      font-size: 0.7em;
    }

    .logo {
      width: 100px;
      margin: 20px 0;
    }

    .flow-diagram {
      background: rgba(50, 50, 50, 0.5);
      border: 2px solid rgba(102, 126, 234, 0.5);
      border-radius: 8px;
      padding: 15px;
      margin-top: 20px;
      text-align: center;
      font-family: 'Courier New', monospace;
      font-size: 0.85em;
    }

    .flow-item {
      display: inline-block;
      background: rgba(102, 126, 234, 0.2);
      border: 2px solid #667eea;
      border-radius: 6px;
      padding: 8px 12px;
      margin: 0 5px;
      font-weight: bold;
      font-size: 0.9em;
    }

    .flow-arrow {
      color: #667eea;
      font-size: 1em;
      margin: 0 5px;
      display: inline-block;
    }
  </style>
</head>
<body>
  <div class="reveal">
    <div class="slides">

      <!-- Slide 1: Title -->
      <section>
        <h1>Backend API with Hono</h1>
        <h3>TypeScript-first Web Framework</h3>
        <p style="margin-top: 60px; font-size: 1.2em;">–ó–∞–Ω—è—Ç–∏–µ 8: –õ–µ–∫—Ü–∏—è</p>
        <p style="margin-top: 20px; font-size: 1em; color: #aaa;">–¢–µ–æ—Ä–∏—è Backend —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏</p>
        <div class="highlight-box" style="margin-top: 40px;">
          <p style="font-size: 0.9em;">–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ –±—É–¥–µ—Ç –Ω–∞ <strong>—Å–ª–µ–¥—É—é—â–µ–π –Ω–µ–¥–µ–ª–µ</strong></p>
        </div>
      </section>

      <!-- Slide 2: –ß—Ç–æ –º—ã –±—É–¥–µ–º –¥–µ–ª–∞—Ç—å -->
      <section>
        <h2>–°–µ–≥–æ–¥–Ω—è —É–∑–Ω–∞–µ–º:</h2>
        <ul>
          <li>üéØ –ö–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω <strong>Hono</strong> —Ñ—Ä–µ–π–º–≤–æ—Ä–∫</li>
          <li>üîß –ö–∞–∫ —Å–æ–∑–¥–∞–≤–∞—Ç—å <strong>REST API</strong endpoints</li>
          <li>üíæ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç <strong>Prisma ORM</strong> –∏ <strong>SQLite</strong></li>
          <li>üîê –ö–∞–∫ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è <strong>JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</strong></li>
          <li>üîó –ö–∞–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å <strong>backend —Å frontend</strong></li>
        </ul>

        <p style="margin-top: 20px; font-size: 0.85em; color: #aaa;">
          –í–∞–∂–Ω–æ: –≠—Ç–æ –Ω–µ –º–æ–±–∏–ª–∫–∞! –≠—Ç–æ —Ä–µ–∞–ª—å–Ω—ã–π backend, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤–µ–∑–¥–µ.
        </p>
      </section>

      <!-- Slide 2.5: –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å–ª–∞–π–¥ –ø—Ä–æ LR5-6 -->
      <section>
        <h2>–ß—Ç–æ –∏–∑–º–µ–Ω—è–µ–º</h2>
        <div class="two-columns">
          <div>
            <h3>–ë—ã–ª–æ (LR5-6)</h3>
            <ul style="font-size: 0.85em;">
              <li>‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –≥–æ—Ç–æ–≤—ã–π API</li>
              <li>‚úÖ Mock-server –∏–ª–∏ –≤–Ω–µ—à–Ω–∏–π</li>
              <li>‚úÖ GET/POST –∑–∞–ø—Ä–æ—Å—ã</li>
              <li>‚úÖ React Query hooks</li>
            </ul>
          </div>
          <div>
            <h3>–°—Ç–∞–Ω–µ—Ç (LR8-9)</h3>
            <ul style="font-size: 0.85em;">
              <li>‚úÖ –°–æ–∑–¥–∞–¥–∏—Ç–µ —Å–≤–æ–π API</li>
              <li>‚úÖ –í–∞—à Hono backend</li>
              <li>‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ endpoints</li>
              <li>‚úÖ Type-safe —Å Prisma</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- Slide 3: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
      <section>
        <h2>–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: Frontend + Backend</h2>
        <div class="two-columns">
          <div>
            <h3>Frontend (LR1-7)</h3>
            <ul style="font-size: 0.9em;">
              <li>React + TypeScript</li>
              <li>Vite + Tailwind</li>
              <li>MobX + Zustand</li>
              <li>Vitest + Playwright</li>
            </ul>
          </div>
          <div>
            <h3>Backend (LR8)</h3>
            <ul style="font-size: 0.9em;">
              <li>Hono + TypeScript</li>
              <li>Prisma ORM</li>
              <li>SQLite Database</li>
              <li>JWT Auth</li>
            </ul>
          </div>
        </div>
        <div class="flow-diagram">
          <div style="margin-bottom: 10px;">
            <span class="flow-item">Frontend</span>
            <span class="flow-arrow">‚Üí</span>
            <span class="flow-item">HTTP</span>
            <span class="flow-arrow">‚Üí</span>
            <span class="flow-item">Backend</span>
          </div>
          <div style="margin-top: 10px;">
            <span class="flow-item">Backend</span>
            <span class="flow-arrow">‚Üí</span>
            <span class="flow-item">SQL</span>
            <span class="flow-arrow">‚Üí</span>
            <span class="flow-item">SQLite</span>
          </div>
        </div>
      </section>

      <!-- Slide 4: –ü–æ—á–µ–º—É Hono? -->
      <section>
        <h2>–ü–æ—á–µ–º—É Hono?</h2>
        <div class="success-box">
          <strong>‚úÖ Hono ‚Äî —ç—Ç–æ –æ–¥–∏–Ω –∏–∑ –ª—É—á—à–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –¥–ª—è –Ω–∞—Å</strong>
        </div>
        <div class="two-columns" style="margin-top: 20px;">
          <div>
            <h4 style="font-size: 1.1em;">Hono</h4>
            <ul style="font-size: 0.75em;">
              <li>üöÄ –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ</li>
              <li>üìù TypeScript-first</li>
              <li>üéØ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π setup</li>
              <li>üîß –í—Å—Ç—Ä–æ–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è</li>
              <li>üíª –†–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ</li>
            </ul>
          </div>
          <div>
            <h4 style="font-size: 1.1em;">Express</h4>
            <ul style="font-size: 0.75em;">
              <li>‚è±Ô∏è –ú–µ–¥–ª–µ–Ω–Ω–µ–µ</li>
              <li>‚ùì TS –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–ª–∞–±–∞—è</li>
              <li>üîß –ú–Ω–æ–≥–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫</li>
              <li>‚öôÔ∏è –ù—É–∂–Ω—ã –¥–æ–ø. –ø–ª–∞–≥–∏–Ω—ã</li>
              <li>‚úÖ –ù–æ –æ—á–µ–Ω—å –ø–æ–ø—É–ª—è—Ä–µ–Ω</li>
            </ul>
          </div>
        </div>
        <p style="margin-top: 20px; font-size: 0.8em; color: #aaa;">Hono –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤: Discord, Cloudflare Workers, Vercel Edge Functions</p>
      </section>

      <!-- Slide 5: Tech Stack -->
      <section>
        <h2>–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫</h2>
        <pre><code>Backend:
‚îú‚îÄ‚îÄ Hono           - Web framework
‚îú‚îÄ‚îÄ Prisma         - ORM –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ SQLite         - –§–∞–π–ª–æ–≤–∞—è –±–∞–∑–∞ (–ª–µ–≥–∫–æ –≤–µ–∑–¥–µ)
‚îú‚îÄ‚îÄ TypeScript     - –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤–µ–∑–¥–µ
‚îú‚îÄ‚îÄ Zod            - Validation + —Ç–∏–ø—ã
‚îî‚îÄ‚îÄ JWT            - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

Frontend:
‚îú‚îÄ‚îÄ React + Vite  - —É–∂–µ –∑–Ω–∞–µ—Ç–µ!
‚îú‚îÄ‚îÄ MobX/Zustand  - —Å–æ—Å—Ç–æ—è–Ω–∏–µ
‚îî‚îÄ‚îÄ TypeScript    - —Ç–∏–ø—ã</code></pre>
      </section>

      <!-- Slide 6: REST API Recap -->
      <section>
        <h2>REST API –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ</h2>
        <table style="font-size: 0.85em; width: 100%;">
          <tr style="background: rgba(102, 126, 234, 0.2);">
            <th>–û–ø–µ—Ä–∞—Ü–∏—è</th>
            <th>HTTP –ú–µ—Ç–æ–¥</th>
            <th>Endpoint</th>
            <th>–ü—Ä–∏–º–µ—Ä</th>
          </tr>
          <tr>
            <td><strong>Create</strong></td>
            <td>POST</td>
            <td>/resources</td>
            <td>POST /api/categories</td>
          </tr>
          <tr>
            <td><strong>Read</strong></td>
            <td>GET</td>
            <td>/resources/:id</td>
            <td>GET /api/categories/123</td>
          </tr>
          <tr>
            <td><strong>Update</strong></td>
            <td>PUT/PATCH</td>
            <td>/resources/:id</td>
            <td>PUT /api/categories/123</td>
          </tr>
          <tr>
            <td><strong>Delete</strong></td>
            <td>DELETE</td>
            <td>/resources/:id</td>
            <td>DELETE /api/categories/123</td>
          </tr>
        </table>
      </section>

      <!-- Slide 7: OpenAPI Schema -->
      <section>
        <h2>OpenAPI Schema —É–∂–µ –µ—Å—Ç—å!</h2>

        <pre style="margin-top: 20px;"><code>lessons/lr5/quiz-api-schema.yaml</code></pre>
        <div class="highlight-box" style="margin-top: 30px;">
          <strong>–ù–∞—à–∞ –∑–∞–¥–∞—á–∞:</strong> –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å backend —Å–æ–≥–ª–∞—Å–Ω–æ —ç—Ç–æ–π —Å—Ö–µ–º–µ
        </div>
        <p style="margin-top: 30px; font-size: 0.9em;">Endpoints –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å:</p>
        <ul style="font-size: 0.85em; margin-top: 15px; list-style: none;">
          <li><code>/api/auth</code> - GitHub OAuth</li>
          <li><code>/api/categories</code> - –¢–µ–º—ã/–∫–∞—Ç–µ–≥–æ—Ä–∏–∏</li>
          <li><code>/api/questions</code> - –í–æ–ø—Ä–æ—Å—ã</li>
          <li><code>/api/sessions</code> - –ò–≥—Ä–æ–≤—ã–µ —Å–µ—Å—Å–∏–∏</li>
          <li><code>/api/admin</code> - –ê–¥–º–∏–Ω—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</li>
        </ul>
      </section>

      <!-- Slide 8: Hono Hello World -->
      <section>
        <h2>Hono: Hello World</h2>
        <pre><code class="typescript">import { Hono } from 'hono';

const app = new Hono();

// –ü—Ä–æ—Å—Ç–æ–π endpoint
app.get('/hello', (c) => {
  return c.json({ message: 'Hello, World!' });
});

// –° –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
app.get('/users/:id', (c) => {
  const id = c.req.param('id');
  return c.json({ userId: id });
});

// POST —Å —Ç–µ–ª–æ–º
app.post('/users', async (c) => {
  const body = await c.req.json();
  return c.json({ created: body }, 201);
});

export default app;</code></pre>
      </section>

      <!-- Slide 9: Prisma ORM -->
      <section>
        <h2>–ß—Ç–æ —Ç–∞–∫–æ–µ Prisma ORM?</h2>
        <p><strong>ORM</strong> = Object-Relational Mapping</p>
        <div class="two-columns" style="margin-top: 30px;">
          <div>
            <h4>–ë–µ–∑ ORM (SQL)</h4>
            <pre style="margin-top: 15px;"><code class="sql">SELECT * FROM users
WHERE id = '123';</code></pre>
            <p style="font-size: 0.8em; margin-top: 15px;">‚ùå –ù–µ—Ç —Ç–∏–ø–æ–≤</p>
            <p style="font-size: 0.8em;">‚ùå –•—Ä—É–ø–∫–æ</p>
          </div>
          <div>
            <h4>–° Prisma</h4>
            <pre style="margin-top: 15px;"><code class="typescript">const user = await prisma
  .user.findUnique({
    where: { id: '123' }
  });</code></pre>
            <p style="font-size: 0.8em; margin-top: 15px;">‚úÖ Type-safe!</p>
            <p style="font-size: 0.8em;">‚úÖ –ú–µ–Ω—å—à–µ –æ—à–∏–±–æ–∫</p>
          </div>
        </div>
      </section>

      <!-- Slide 10: Prisma Schema -->
      <section>
        <h2>Prisma Schema: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</h2>
        <pre><code class="prisma">model User {
  id            String    @id @default(cuid())
  githubId      Int       @unique
  githubUsername String   @unique
  email         String?
  role          UserRole  @default(STUDENT)
  createdAt     DateTime  @default(now())

  sessions      Session[]  // –û–¥–∏–Ω –∫–æ –º–Ω–æ–≥–∏–º
}

enum UserRole {
  STUDENT
  ADMIN
}

model Session {
  id        String  @id @default(cuid())
  userId    String
  user      User    @relation(fields: [userId], references: [id])
  createdAt DateTime @default(now())
}</code></pre>
        <p style="font-size: 0.85em; margin-top: 20px; color: #aaa;">Prisma –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç TypeScript —Ç–∏–ø—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!</p>
      </section>

      <!-- Slide 11: Database Setup -->
      <section>
        <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö</h2>
        <pre><code class="bash"># 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å Prisma
npm install @prisma/client prisma

# 2. –°–æ–∑–¥–∞—Ç—å .env
DATABASE_URL="file:./dev.db"

# 3. –ù–∞–ø–∏—Å–∞—Ç—å schema.prisma

# 4. –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
npx prisma migrate dev --name init

# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
npx prisma studio  # –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ë–î</code></pre>
        <div class="success-box" style="margin-top: 30px;">
          SQLite —Å–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª <code>dev.db</code> –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
        </div>
      </section>

      <!-- Slide 12: JWT Authentication -->
      <section>
        <h2>JWT (JSON Web Token)</h2>
        <p style="margin-top: 20px;">JWT –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏</p>
        <pre style="margin-top: 30px;"><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9
.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ
.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c</code></pre>
        <div class="two-columns" style="margin-top: 40px;">
          <div>
            <h4>‚úÖ –ß—Ç–æ JWT –¥–µ–ª–∞–µ—Ç:</h4>
            <ul style="font-size: 0.75em;">
              <li>–ö–æ–¥–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ</li>
              <li>–ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è secret –∫–ª—é—á–æ–º</li>
              <li>–ó–∞—â–∏—â—ë–Ω –æ—Ç –ø–æ–¥–¥–µ–ª–æ–∫</li>
              <li>Stateless (–Ω–µ –Ω—É–∂–Ω–∞ –ë–î)</li>
            </ul>
          </div>
          <div>
            <h4>–ü–æ—Ç–æ–∫:</h4>
            <ul style="font-size: 0.75em;">
              <li>1Ô∏è‚É£ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ª–æ–≥–∏–Ω–∏—Ç—Å—è</li>
              <li>2Ô∏è‚É£ –°–µ—Ä–≤–µ—Ä –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç JWT</li>
              <li>3Ô∏è‚É£ –§—Ä–æ–Ω—Ç–µ–Ω–¥ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç JWT</li>
              <li>4Ô∏è‚É£ –§—Ä–æ–Ω—Ç–µ–Ω–¥ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ header</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- Slide 13: JWT –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ -->
      <section>
        <h2>JWT –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –≤ Hono</h2>
        <pre><code class="typescript">import jwt from 'jsonwebtoken';

// –°–æ–∑–¥–∞—Ç—å JWT
function createToken(userId: string) {
  return jwt.sign(
    { userId },
    process.env.JWT_SECRET!,
    { expiresIn: '7d' }
  );
}

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å JWT
function verifyToken(token: string) {
  try {
    return jwt.verify(token, process.env.JWT_SECRET!);
  } catch (error) {
    return null;
  }
}

// Middleware –¥–ª—è –∑–∞—â–∏—Ç—ã endpoint
app.use('/api/protected/*', async (c, next) => {
  const auth = c.req.header('Authorization');
  const token = auth?.replace('Bearer ', '');

  if (!token) return c.json({ error: 'Unauthorized' }, 401);

  const payload = verifyToken(token);
  if (!payload) return c.json({ error: 'Invalid token' }, 401);

  c.set('userId', payload.userId);
  await next();
});</code></pre>
      </section>

      <!-- Slide 13.5: Hono JWT Helper (–∏–¥–∏–æ–º–∞—Ç–∏—á–Ω—ã–π —Å–ø–æ—Å–æ–±) -->
      <section>
        <h2>JWT –≤ Hono: –º–æ–ª–æ–¥–µ–∂–Ω–æ</h2>
        <p>–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Hono JWT helper:</p>
        <pre><code class="typescript">import { Hono } from 'hono';
import { jwt } from 'hono/jwt';

const app = new Hono();

// Middleware - –∑–∞—â–∏—Ç–∞ endpoint
app.use('/api/protected/*', jwt({
  secret: process.env.JWT_SECRET!
}));

// –í handler –ø–æ–ª—É—á–∏—Ç—å payload
app.get('/api/protected/me', (c) => {
  const payload = c.get('jwtPayload');
  return c.json({ userId: payload.userId });
});

// –°–æ–∑–¥–∞—Ç—å —Ç–æ–∫–µ–Ω (–≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ –ª–æ–≥–∏–Ω–∞)
app.post('/api/auth/login', async (c) => {
  const payload = { userId: user.id, role: user.role };
  const token = await Jwt.sign(
    payload,
    process.env.JWT_SECRET!
  );
  return c.json({ token });
});</code></pre>
        <div class="success-box">
          <strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:</strong> –ú–µ–Ω—å—à–µ –∫–æ–¥–∞, –≤—Å—Ç—Ä–æ–µ–Ω–æ –≤ Hono, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ
        </div>
      </section>

      <!-- Slide 14: Zod Validation -->
      <section>
        <h2>Zod: Type-safe Validation</h2>
        <pre><code class="typescript">import { z } from 'zod';

// –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å schema
const CreateCategorySchema = z.object({
  name: z.string().min(1).max(100),
  slug: z.string().regex(/^[a-z0-9-]+$/),
  description: z.string().optional(),
});

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ handler
app.post('/categories', async (c) => {
  try {
    const body = await c.req.json();

    // –í–∞–ª–∏–¥–∞—Ü–∏—è + —Ç–∏–ø–∏–∑–∞—Ü–∏—è!
    const { name, slug, description } =
      CreateCategorySchema.parse(body);

    const category = await prisma.category.create({
      data: { name, slug, description }
    });

    return c.json(category, 201);
  } catch (error) {
    return c.json({ error: 'BadRequest' }, 400);
  }
});</code></pre>
      </section>

      <!-- Slide 15: Handlers —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ -->
      <section>
        <h2>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ handlers</h2>
        <pre><code class="typescript">// src/handlers/categories.ts
import { Hono } from 'hono';
import { prisma } from '../db/client';

const router = new Hono();

// GET /api/categories
router.get('/', async (c) => {
  const categories = await prisma.category.findMany();
  return c.json({ categories });
});

// POST /api/categories
router.post('/', async (c) => {
  // –≤–∞–ª–∏–¥–∞—Ü–∏—è...
  const category = await prisma.category.create({...});
  return c.json(category, 201);
});

export default router;

// –í main app:
import categoriesRoutes from './handlers/categories';
app.route('/api/categories', categoriesRoutes);</code></pre>
      </section>

      <!-- Slide 16: Integration —Å Frontend -->
      <section>
        <h2>–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Frontend</h2>
        <p>–í —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–∞–º–µ–Ω–∏—Ç–µ mock API:</p>
        <pre><code class="typescript">// –ë—ã–ª–æ (LR5-6)
const API_URL = 'http://localhost:3001'; // mock-server

// –¢–µ–ø–µ—Ä—å (LR8)
const API_URL = 'http://localhost:3000'; // —Ä–µ–∞–ª—å–Ω—ã–π backend</code></pre>
        <p style="margin-top: 30px; font-size: 0.9em;">–í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç:
        <ul style="font-size: 0.85em;">
          <li>–¢–µ—Å—Ç—ã —Ç–µ—Å—Ç–∏—Ä—É—é—Ç —Ä–µ–∞–ª—å–Ω—ã–π –∫–æ–¥</li>
          <li>MobX store –≥–æ–≤–æ—Ä–∏—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º backend</li>
          <li>–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ SQLite</li>
        </ul>
      </section>

      <!-- Slide 17: –ó–∞–ø—É—Å–∫ -->
      <section>
        <h2>–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</h2>
        <pre><code class="bash"># Terminal 1: Backend
cd lessons/lr8/backend
npm install
npm run dev
# Server runs on http://localhost:3000

# Terminal 2: Frontend
cd lessons/lr5  # –∏–ª–∏ –≥–¥–µ –≤–∞—à —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
npm run dev
# App runs on http://localhost:5173</code></pre>
        <div class="success-box" style="margin-top: 30px;">
          <strong>‚úÖ –ì–æ—Ç–æ–≤–æ!</strong> –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –Ω–∞ http://localhost:5173 –∏ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º backend!
        </div>
      </section>

      <!-- Slide 18: Endpoints –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω—ã -->
      <section>
        <h2>Endpoints –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (LR8)</h2>
        <ul style="font-size: 0.8em;">
          <li><strong>Auth:</strong> POST /api/auth/github/callback, GET /api/auth/me</li>
          <li><strong>Categories:</strong> GET /api/categories, POST /api/categories</li>
          <li><strong>Questions:</strong> GET /api/questions, GET /api/admin/questions</li>
          <li><strong>Sessions:</strong> POST /api/sessions, GET /api/sessions/:id, POST /api/sessions/:id/answers</li>
          <li><strong>Admin:</strong> PUT /api/admin/users/:id/difficulty, POST /api/admin/answers/:id/grade</li>
        </ul>
        <div class="highlight-box" style="margin-top: 30px;">
          <strong>–¶–µ–ª—å LR8:</strong> –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å ~60% endpoints
        </div>
      </section>

      <!-- Slide 19: Error Handling -->
      <section>
        <h2>–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫</h2>
        <pre><code class="typescript">// –ü–ª–æ—Ö–æ ‚ùå
app.post('/data', async (c) => {
  const data = await someFunction(); // –ß—Ç–æ –µ—Å–ª–∏ error?
  return c.json(data);
});

// –•–æ—Ä–æ—à–æ ‚úÖ
app.post('/data', async (c) => {
  try {
    const body = await c.req.json();

    // –í–∞–ª–∏–¥–∞—Ü–∏—è
    const validated = MySchema.parse(body);

    // –û–±—Ä–∞–±–æ—Ç–∫–∞
    const result = await someFunction(validated);

    return c.json(result, 200);
  } catch (error) {
    console.error(error);
    return c.json({
      error: 'BadRequest',
      message: 'Invalid data'
    }, 400);
  }
});</code></pre>
      </section>

      <!-- Slide 20: Common mistakes -->
      <section>
        <h2>–ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏</h2>
        <div class="error-box">
          <strong>‚ùå –ó–∞–±—ã–ª–∏ await –¥–ª—è async –æ–ø–µ—Ä–∞—Ü–∏–π</strong>
          <pre><code class="typescript">const user = prisma.user.findUnique({...}); // –û—à–∏–±–∫–∞!
const user = await prisma.user.findUnique({...}); // –ü—Ä–∞–≤–∏–ª—å–Ω–æ</code></pre>
        </div>
        <div class="error-box">
          <strong>‚ùå –ó–∞–±—ã–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</strong>
          <pre><code class="typescript">const data = schema.parse(body); // –ú–æ–∂–µ—Ç –≤—ã–±—Ä–æ—Å–∏—Ç—å error!
try {
  const data = schema.parse(body);
} catch (e) {
  return c.json({ error: 'BadRequest' }, 400);
}</code></pre>
        </div>
        <div class="error-box">
          <strong>‚ùå –ó–∞–±—ã–ª–∏ –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç</strong>
          <pre><code class="typescript">c.json(data); // –û—à–∏–±–∫–∞! –ó–∞–±—ã–ª–∏ return
return c.json(data); // –ü—Ä–∞–≤–∏–ª—å–Ω–æ</code></pre>
        </div>
      </section>

      <!-- Slide 21: Testing Backend -->
      <section>
        <h2>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Backend (Preview)</h2>
        <p style="margin-top: 20px;">–ù–∞ LR10 –±—É–¥–µ–º –ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã:</p>
        <pre style="margin-top: 30px;"><code class="typescript">import { describe, it, expect } from 'vitest';
import { testClient } from 'hono/testing';
import app from '../src/index';

describe('Categories API', () => {
  it('GET /api/categories returns list', async () => {
    const client = testClient(app);
    const res = await client.api.categories.$get();

    expect(res.status).toBe(200);
    expect(res.body).toHaveProperty('categories');
  });
});</code></pre>
        <p style="font-size: 0.85em; margin-top: 20px; color: #aaa;">–ù–æ —Å–µ–π—á–∞—Å —Ñ–æ–∫—É—Å–∏–º—Å—è –Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏!</p>
      </section>

      <!-- Slide 22: Performance Tips -->
      <section>
        <h2>Performance Tips</h2>
        <ul style="font-size: 0.9em;">
          <li><strong>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ select</strong> –≤ Prisma –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã—Ö –ø–æ–ª–µ–π</li>
          <li><strong>–ò–Ω–¥–µ–∫—Å–∏—Ä—É–π—Ç–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è</strong> (githubId, slug)</li>
          <li><strong>–ö—ç—à–∏—Ä—É–π—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</strong> (–º–µ–Ω—è—é—Ç—Å—è —Ä–µ–¥–∫–æ)</li>
          <li><strong>–ü–∞–≥–∏–Ω–∏—Ä—É–π—Ç–µ —Å–ø–∏—Å–∫–∏</strong> (–Ω–µ –±–µ—Ä–∏—Ç–µ –º–∏–ª–ª–∏–æ–Ω –∑–∞–ø–∏—Å–µ–π)</li>
          <li><strong>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ connection pooling</strong> (–µ—Å–ª–∏ –±—É–¥–µ—Ç –±–æ–ª—å)</li>
        </ul>
        <pre style="margin-top: 30px;"><code class="typescript">// –•–æ—Ä–æ—à–æ: –±–µ—Ä–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è
const categories = await prisma.category.findMany({
  select: { id: true, name: true, slug: true }
});

// –•–æ—Ä–æ—à–æ: –ø–∞–≥–∏–Ω–∞—Ü–∏—è
const categories = await prisma.category.findMany({
  skip: (page - 1) * limit,
  take: limit
});</code></pre>
      </section>

      <!-- Slide 23: Security Best Practices -->
      <section>
        <h2>Security: –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞</h2>
        <ul style="font-size: 0.9em;">
          <li><strong>–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ª–æ–≥–∏—Ä—É–π—Ç–µ –ø–∞—Ä–æ–ª–∏ –∏ —Ç–æ–∫–µ–Ω—ã</strong></li>
          <li><strong>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ .env –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤</strong> (–Ω–µ –≤ –∫–æ–¥–µ!)</li>
          <li><strong>–í–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ –í–°–ï –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</strong> (SQL injection!)</li>
          <li><strong>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –≤ production</strong></li>
          <li><strong>–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞</strong> (admin vs student)</li>
          <li><strong>–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π—Ç–µ rate limits</strong> (–ø–æ—Ç–æ–º –Ω–∞ LR11)</li>
        </ul>
        <pre style="margin-top: 30px;"><code class="bash"># .env (–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤ git!)
JWT_SECRET="super-secret-key-change-in-production"
DATABASE_URL="file:./dev.db"
NODE_ENV="development"</code></pre>
      </section>

      <!-- Slide 24: –ß—Ç–æ –¥–∞–ª—å—à–µ -->
      <section>
        <h2>–ü–æ—Å–ª–µ LR8</h2>
        <div class="two-columns">
          <div>
            <h3>LR9: Database & Scoring</h3>
            <ul style="font-size: 0.85em;">
              <li>Scoring algorithm</li>
              <li>Advanced Prisma</li>
              <li>Transactions</li>
              <li>Normalization</li>
            </ul>
          </div>
          <div>
            <h3>LR10: Testing</h3>
            <ul style="font-size: 0.85em;">
              <li>Vitest –¥–ª—è backend</li>
              <li>Integration tests</li>
              <li>Coverage</li>
              <li>Fixtures</li>
            </ul>
          </div>
        </div>
        <div class="highlight-box" style="margin-top: 40px;">
          <strong>–ü—Ä–æ–≥—Ä–µ—Å—Å:</strong> LR8 (Backend) ‚Üí LR9 (DB) ‚Üí LR10 (Testing) ‚Üí LR11 (Docker) ‚Üí LR12 (PWA) ‚Üí LR13 (–ò—Ç–æ–≥)
        </div>
      </section>

      <!-- Slide 25: Summary -->
      <section>
        <h2>–ò—Ç–æ–≥–∏</h2>
        <div class="success-box">
          <h3>‚úÖ –°–µ–≥–æ–¥–Ω—è –≤—ã —É–∑–Ω–∞–ª–∏:</h3>
          <ul style="font-size: 0.85em;">
            <li>Hono —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –∏ –∫–∞–∫ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç</li>
            <li>REST API –∏ HTTP –º–µ—Ç–æ–¥—ã</li>
            <li>Prisma ORM –∏ SQLite</li>
            <li>JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</li>
            <li>Zod –≤–∞–ª–∏–¥–∞—Ü–∏—è</li>
            <li>–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è backend —Å frontend</li>
          </ul>
        </div>
      </section>
    </div>
  </div>

  <script src="reveal.js"></script>
  <script src="markdown.js"></script>
  <script src="highlight.js"></script>
  <script src="notes.js"></script>

  <script>
    Reveal.initialize({
      hash: true,
      center: true,
      transition: 'slide',
      width: 960,
      height: 700,
      margin: 0.1,
      minScale: 0.2,
      maxScale: 2.0,
    });
  </script>
</body>
</html>
